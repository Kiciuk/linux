# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/display/msm/qcom,adreno-330.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Qualcomm Adreno 3xx GPU

maintainers:
  - Rob Clark <robdclark@gmail.com>

description:
  Device tree bindings for Adreno 330 GPU.

select:
  properties:
    compatible:
      contains:
        enum:
          - qcom,adreno-305.18
          - qcom,adreno-330.1
  required:
    - compatible


properties:
  $nodename:
    pattern: "^gpu@[0-9a-f]+$"

  compatible:
    items:
      - enum:
          - qcom,adreno-305.18
          - qcom,adreno-330.1
      - const: qcom,adreno
  reg:
    items:
      - description: base address of GPU device

  reg-names:
    items:
      - const: kgsl_3d0_reg_memory

  clocks:
    items:
      - description: GPU Core clock
      - description: GPU Interface clock
      - description: GPU Memory Interface clock

  clock-names:
    items:
      - const: core
      - const: iface
      - const: mem_iface

  interconnects:
    minItems: 1
    maxItems: 2

  interconnect-names:
    minItems: 1
    items:
      - const: gfx-mem
      - const: ocmem

  interrupts:
    maxItems: 1

  interrupt-names:
    maxItems: 1
  
  iommus:
    items:
      - description: Phandle to gpu smmu

  sram:
    $ref: /schemas/types.yaml#/definitions/phandle-array
    minItems: 1
    maxItems: 4
    items:
      maxItems: 1
    description: |
      phandles to one or more reserved on-chip SRAM regions.
      phandle to the On Chip Memory (OCMEM) that's present on some a3xx and
      a4xx Snapdragon SoCs. See
      Documentation/devicetree/bindings/sram/qcom,ocmem.yaml

  power-domains:
    maxItems: 1

  operating-points-v2: true
  opp-table:
    type: object

  "#cooling-cells":
    const: 2

required:
  - reg
  - reg-names
  - clocks
  - clock-names
  - interrupts
  - interrupt-names
  - iommus
  - power-domains

unevaluatedProperties: false

examples:
  - |
    // Example a330 :

    #include <dt-bindings/clock/qcom,gcc-msm8974.h>
    #include <dt-bindings/clock/qcom,mmcc-msm8974.h>
    #include <dt-bindings/power/qcom-rpmpd.h>
    #include <dt-bindings/interrupt-controller/irq.h>
    #include <dt-bindings/interrupt-controller/arm-gic.h>

    gpu@fdb00000 {
        compatible = "qcom,adreno-330.1", "qcom,adreno";

        reg = <0xfdb00000 0x10000>;
        reg-names = "kgsl_3d0_reg_memory";

        interrupts = <GIC_SPI 33 IRQ_TYPE_LEVEL_HIGH>;
        interrupt-names = "kgsl_3d0_irq";

        clocks = <&mmcc OXILI_GFX3D_CLK>,
                 <&mmcc OXILICX_AHB_CLK>,
                 <&mmcc OXILICX_AXI_CLK>;

        clock-names = "core",
                      "iface",
                      "mem_iface";

        power-domains = <&mmcc OXILICX_GDSC>;
        iommus = <&gpu_iommu 0>;

        sram = <&gmu_sram>;
        operating-points-v2 = <&gpu_opp_table>;

        #cooling-cells = <2>;

        gpu_opp_table: opp-table {
            compatible = "operating-points-v2";

            opp-27000000 {
                opp-hz = /bits/ 64 <27000000>;
            };

            opp-200000000  {
                opp-hz = /bits/ 64 <200000000>;
            };

            opp-320000000  {
                opp-hz = /bits/ 64 <320000000>;
            };
        };
    };
