# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/display/msm/qcom,adreno-540.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Qualcomm Adreno 5xx GPU

maintainers:
  - Rob Clark <robdclark@gmail.com>

description:
  Device tree bindings for Adreno 540 GPU.

select:
  properties:
    compatible:
      contains:
        enum: 
          - qcom,adreno-508.0
          - qcom,adreno-512.0
          - qcom,adreno-540.1
  required:
    - compatible

$ref: /schemas/display/msm/qcom,adreno-common.yaml#

properties:
  compatible:
    items:
      - enum:
          - qcom,adreno-508.0
          - qcom,adreno-512.0
          - qcom,adreno-540.1
      - const: qcom,adreno
  reg:
    items:
      - description: base address of GPU device

  reg-names:
    items:
      - const: kgsl_3d0_reg_memory

  clocks:
    items: 
      - description: GPU Interface clock
      - description: GPU RBBM Timer for Adreno 5xx series
      - description: GPU Memory clock
      - description: GPU Memory Interface clock
      - description: GPU RBCPR clock
      - description: GPU Core clock

  clock-names:
    items:
      - const: iface
      - const: rbbmtimer
      - const: mem
      - const: mem_iface
      - const: rbcpr
      - const: core

required:
  - clocks
  - clock-names
  - power-domains

unevaluatedProperties: false

examples:
  - |
    // Example a540 :

    #include <dt-bindings/clock/qcom,gcc-msm8998.h>
    #include <dt-bindings/clock/qcom,gpucc-msm8998.h>
    #include <dt-bindings/power/qcom-rpmpd.h>
    #include <dt-bindings/interrupt-controller/irq.h>
    #include <dt-bindings/interrupt-controller/arm-gic.h>

    gpu@5000000 {
        compatible = "qcom,adreno-540.1", "qcom,adreno";

        reg = <0x05000000 0x40000>;
        reg-names = "kgsl_3d0_reg_memory";

        interrupts = <GIC_SPI 300 IRQ_TYPE_LEVEL_HIGH>;
        
        clocks = <&gcc GCC_GPU_CFG_AHB_CLK>,
                 <&gpucc RBBMTIMER_CLK>,
                 <&gcc GCC_BIMC_GFX_CLK>,
                 <&gcc GCC_GPU_BIMC_GFX_CLK>,
                 <&gpucc RBCPR_CLK>,
                 <&gpucc GFX3D_CLK>;
        
        clock-names = "iface",
                      "rbbmtimer",
                      "mem",
                      "mem_iface",
                      "rbcpr",
                      "core";

        power-domains = <&rpmpd MSM8998_VDDMX>;
        iommus = <&adreno_smmu 0>;

        operating-points-v2 = <&gpu_opp_table>;

        #cooling-cells = <2>;
        
        gpu_opp_table: opp-table {
            compatible = "operating-points-v2";

            opp-710000097 {
                opp-hz = /bits/ 64 <710000097>;
                opp-level = <RPM_SMD_LEVEL_TURBO>;
                opp-supported-hw = <0xff>;
            };

           opp-670000048 {
                opp-hz = /bits/ 64 <670000048>;
                opp-level = <RPM_SMD_LEVEL_NOM_PLUS>;
                opp-supported-hw = <0xff>;
            };

            opp-596000097 {
                opp-hz = /bits/ 64 <596000097>;
                opp-level = <RPM_SMD_LEVEL_NOM>;
                opp-supported-hw = <0xff>;
            };

            opp-515000097 {
                opp-hz = /bits/ 64 <515000097>;
                opp-level = <RPM_SMD_LEVEL_SVS_PLUS>;
                opp-supported-hw = <0xff>;
            };
            
            opp-414000000 {
                opp-hz = /bits/ 64 <414000000>;
                opp-level = <RPM_SMD_LEVEL_SVS>;
                opp-supported-hw = <0xff>;
            };
            
            opp-342000000 {
                opp-hz = /bits/ 64 <342000000>;
                opp-level = <RPM_SMD_LEVEL_LOW_SVS>;
                opp-supported-hw = <0xff>;
            };
            
            opp-257000000 {
                opp-hz = /bits/ 64 <257000000>;
                opp-level = <RPM_SMD_LEVEL_MIN_SVS>;
                opp-supported-hw = <0xff>;
            };
        };
    };

